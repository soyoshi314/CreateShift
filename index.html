<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚·ãƒ•ãƒˆå…¥åŠ›ã‚¢ãƒ—ãƒª</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --primary-hover: #1d4ed8;
            --success-color: #10b981;
            --success-hover: #059669;
            --danger-color: #ef4444;
            --danger-hover: #dc2626;
            --warning-color: #f59e0b;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --border-radius: 12px;
            --transition: all 0.2s ease;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans', sans-serif;
            line-height: 1.6;
            color: var(--gray-800);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            margin-bottom: 100px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, #3b82f6 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .header p {
            opacity: 0.9;
            font-size: 0.95rem;
        }

        .content {
            padding: 30px;
        }

        /* å…¥åŠ›ã‚°ãƒ«ãƒ¼ãƒ— */
        .input-group {
            margin-bottom: 24px;
        }

        .input-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--gray-700);
            font-size: 0.95rem;
        }

        .select-wrapper {
            position: relative;
        }

        #mainTextBox {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            background: white;
            cursor: pointer;
        }

        #mainTextBox:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        textarea#commentBox {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            font-size: 0.95rem;
            resize: vertical;
            transition: var(--transition);
            font-family: inherit;
        }

        textarea#commentBox:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        /* è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        .alert {
            background: #fef3c7;
            border-left: 4px solid var(--warning-color);
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 24px;
        }

        .alert ul {
            margin-left: 20px;
        }

        .alert li {
            margin-bottom: 4px;
            color: #92400e;
        }

        /* ç›®æ¬¡ */
        .toc {
            background: var(--gray-50);
            border: 2px solid var(--gray-200);
            border-radius: var(--border-radius);
            padding: 24px;
            margin-bottom: 32px;
        }

        .toc h3 {
            font-size: 1.25rem;
            margin-bottom: 16px;
            color: var(--gray-800);
        }

        .toc ul {
            list-style: none;
        }

        .toc li {
            margin-bottom: 8px;
        }

        .toc a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            display: inline-block;
        }

        .toc a:hover {
            color: var(--primary-hover);
            transform: translateX(4px);
        }

        /* ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ« */
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gray-800);
            margin: 40px 0 24px;
            padding-bottom: 12px;
            border-bottom: 3px solid var(--primary-color);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-title::before {
            content: '';
            width: 6px;
            height: 30px;
            background: var(--primary-color);
            border-radius: 3px;
        }

        /* ã‚·ãƒ•ãƒˆãƒ–ãƒ­ãƒƒã‚¯ */
        .shift-block {
            background: white;
            border: 2px solid var(--gray-200);
            border-radius: var(--border-radius);
            padding: 24px;
            margin-bottom: 24px;
            transition: var(--transition);
        }

        .shift-block:hover {
            border-color: var(--gray-300);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .block-title {
            font-size: 1.15rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 8px;
            display: block;
        }

        .block-description {
            color: var(--gray-600);
            font-size: 0.9rem;
            line-height: 1.6;
            margin-bottom: 16px;
        }

        .note-red {
            color: var(--danger-color);
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* ä¸€æ‹¬é¸æŠãƒœã‚¿ãƒ³ */
        .batch-select-container {
            margin: 16px 0;
            padding: 12px;
            background: var(--gray-50);
            border-radius: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .batch-select-btn {
            background: white;
            border: 2px solid var(--gray-300);
            padding: 6px 16px;
            font-size: 0.85rem;
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            color: var(--gray-700);
        }

        .batch-select-btn:hover {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        .batch-select-btn:active {
            transform: translateY(0);
        }

        /* ã‚·ãƒ•ãƒˆè¡Œ */
        .shift-line {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 12px;
            padding: 8px;
            border-radius: 8px;
            transition: var(--transition);
        }

        .shift-line:hover {
            background: var(--gray-50);
        }

        .date-entry {
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 8px;
            border: 2px solid var(--gray-200);
            background: white;
            transition: var(--transition);
            min-width: 70px;
            text-align: center;
            font-weight: 600;
            color: var(--gray-700);
            font-size: 0.9rem;
        }

        .date-entry:hover {
            border-color: var(--primary-color);
            background: var(--gray-50);
            transform: translateY(-2px);
        }

        .date-entry.selected {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .assignee {
            color: var(--danger-color);
            font-weight: 700;
            padding: 4px 12px;
            background: #fee2e2;
            border-radius: 6px;
        }

        .secondary-option {
            padding: 6px 12px;
            border-radius: 6px;
            border: 2px solid var(--gray-300);
            background: white;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.85rem;
            font-weight: 500;
        }

        .secondary-option:hover:not(.disabled) {
            border-color: var(--success-color);
            background: var(--gray-50);
        }

        .secondary-option.disabled {
            opacity: 0.4;
            cursor: not-allowed;
            background: var(--gray-100);
        }

        .secondary-option.selected {
            background: var(--success-color);
            border-color: var(--success-color);
            color: white;
        }

        .appended-text {
            color: var(--success-color);
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* ãƒœã‚¿ãƒ³ */
        .button-container {
            text-align: center;
            margin-top: 40px;
            display: flex;
            gap: 16px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .action-button {
            padding: 14px 32px;
            font-size: 1.05rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            transition: var(--transition);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .action-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }

        .action-button:active:not(:disabled) {
            transform: translateY(0);
        }

        #sendButton {
            background: var(--success-color);
            color: white;
        }

        #sendButton:hover:not(:disabled) {
            background: var(--success-hover);
        }

        #confirmButton {
            background: var(--primary-color);
            color: white;
        }

        #confirmButton:hover:not(:disabled) {
            background: var(--primary-hover);
        }

        .action-button:disabled {
            background: var(--gray-300);
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

        /* é€šçŸ¥ */
        #notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--success-color);
            color: white;
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            font-weight: 600;
        }

        #notification.show {
            opacity: 1;
        }

        #notification.error {
            background: var(--danger-color);
        }

        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° */
        #loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 1001;
            color: white;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-top: 4px solid white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.1rem;
            text-align: center;
            line-height: 1.6;
        }

        /* çµæœè¡¨ç¤º */
        #submission-result {
            padding: 24px;
        }

        #result-shifts-list ul {
            list-style: none;
        }

        #result-shifts-list li {
            background: var(--gray-50);
            border: 2px solid var(--gray-200);
            padding: 16px;
            margin-bottom: 12px;
            border-radius: 8px;
        }

        #result-shifts-list h4 {
            color: var(--primary-color);
            font-size: 1.1rem;
            margin-bottom: 8px;
        }

        #result-comment {
            white-space: pre-wrap;
            background: var(--gray-50);
            border: 2px solid var(--gray-200);
            padding: 16px;
            border-radius: 8px;
        }

        #copyButton {
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            color: white;
            background: var(--primary-color);
            border: none;
            border-radius: 8px;
            transition: var(--transition);
            margin-top: 20px;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        #copyButton:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
        }

        /* å›ºå®šãƒœã‚¿ãƒ³ */
        .fixed-button {
            position: fixed;
            right: 20px;
            z-index: 999;
            background: var(--gray-700);
            color: white;
            width: 160px;
            height: 50px;
            text-decoration: none;
            text-align: center;
            line-height: 50px;
            font-size: 0.9rem;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            border-radius: 25px;
            transition: var(--transition);
        }

        .fixed-button:hover {
            background: var(--gray-600);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
        }

        #back-to-toc-btn {
            bottom: 90px;
        }

        #submit-shift-btn {
            bottom: 20px;
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5rem;
            }

            .content {
                padding: 20px;
            }

            .section-title {
                font-size: 1.25rem;
            }

            .batch-select-container {
                gap: 6px;
            }

            .batch-select-btn {
                font-size: 0.8rem;
                padding: 4px 12px;
            }

            .date-entry {
                min-width: 65px;
                padding: 5px 10px;
                font-size: 0.85rem;
            }

            .fixed-button {
                width: 50px;
                height: 50px;
                font-size: 0.7rem;
                border-radius: 50%;
                overflow: hidden;
                text-indent: -9999px;
            }

            .fixed-button::before {
                content: 'â†‘';
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                text-indent: 0;
                font-size: 1.5rem;
            }

            #submit-shift-btn::before {
                content: 'â†“';
            }
        }
    </style>
</head>
<body>
    <div id="loading-overlay">
        <div class="spinner"></div>
        <div class="loading-text">
            ã‚·ãƒ•ãƒˆæå‡ºä¸­<br>
            æå‡ºã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚<br>
            ç”»é¢ã‹ã‚‰é›¢ã‚Œã¦ã‚‚å¤§ä¸ˆå¤«ã§ã™ã€‚
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1 id="page-title-display">ã‚·ãƒ•ãƒˆå…¥åŠ›</h1>
            <p>ã‚·ãƒ•ãƒˆå¸Œæœ›ã‚’å…¥åŠ›ã—ã¦æå‡ºã—ã¦ãã ã•ã„</p>
        </div>

        <div class="content">
            <div id="submission-result" style="display: none;">
                <h2 class="section-title">æå‡ºæ¸ˆã¿ã®ã‚·ãƒ•ãƒˆ</h2>
                <p><strong id="result-magician-name"></strong>ã•ã‚“ã®æå‡ºå†…å®¹ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚</p>
                <div id="result-shifts-list"></div>
                <div id="result-comment-area" style="display: none;">
                    <h3 style="margin-top: 30px; font-size: 1.2rem;">ã‚³ãƒ¡ãƒ³ãƒˆ</h3>
                    <p id="result-comment"></p>
                </div>
                <div style="text-align: center;">
                    <button id="copyButton">ã‚·ãƒ•ãƒˆä¸€è¦§ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼</button>
                </div>
            </div>

            <div id="shift-input-form">
                <div class="input-group">
                    <label for="mainTextBox">ãƒã‚¸ã‚·ãƒ£ãƒ³å</label>
                    <select id="mainTextBox">
                        <option value="" disabled selected>é¸æŠã—ã¦ãã ã•ã„</option>
                        <option value="ç¿”">ç¿”</option>
                        <option value="è—¤æœ¬æ˜ç¾©">è—¤æœ¬æ˜ç¾©</option>
                        <option value="ãŠã¯ãã€‚">ãŠã¯ãã€‚</option>
                        <option value="UKYO">UKYO</option>
                        <option value="ã‚«ãƒ³ã‚¸">ã‚«ãƒ³ã‚¸</option>
                        <option value="ã—ã‚…ã‚“">ã—ã‚…ã‚“</option>
                        <option value="é›…">é›…</option>
                        <option value="ãƒ”ãƒ¼ãƒ­">ãƒ”ãƒ¼ãƒ­</option>
                        <option value="ã‚¬ã‚¯">ã‚¬ã‚¯</option>
                        <option value="ç¾ç¾½">ç¾ç¾½</option>
                        <option value="ã¨ã‚“">ã¨ã‚“</option>
                        <option value="æš">æš</option>
                        <option value="ãƒãƒ¼ãƒ‰ãƒãƒ³">ãƒãƒ¼ãƒ‰ãƒãƒ³</option>
                        <option value="ãƒ«ãƒ¼ãƒˆ">ãƒ«ãƒ¼ãƒˆ</option>
                        <option value="NANA">NANA</option>
                        <option value="åŸå±±é€²">åŸå±±é€²</option>
                        <option value="NAOKO">NAOKO</option>
                        <option value="ãƒ’ãƒ©ã‚¯">ãƒ’ãƒ©ã‚¯</option>
                        <option value="ãµãªã¯ã—">ãµãªã¯ã—</option>
                        <option value="SEID">SEID</option>
                        <option value="mirror">mirror</option>
                        <option value="ã‚ªãƒ¼ã‚¤ã‚ºãƒŸ">ã‚ªãƒ¼ã‚¤ã‚ºãƒŸ</option>
                        <option value="ã¨ã£ã´">ã¨ã£ã´</option>
                        <option value="key">key</option>
                        <option value="ã¨ã‚‚">ã¨ã‚‚</option>
                        <option value="Aiki">Aiki</option>
                        <option value="Sho-Ta">Sho-Ta</option>
                        <option value="ãƒ’ã‚«ãƒ«">ãƒ’ã‚«ãƒ«</option>
                        <option value="ã‚„ã¿">ã‚„ã¿</option>
                        <option value="ç´™éº»å‘‚">ç´™éº»å‘‚</option>
                        <option value="ãƒãƒƒãƒ”ã‚¤å‰æ²¢">ãƒãƒƒãƒ”ã‚¤å‰æ²¢</option>
                        <option value="ãªãŠã´ãƒ¼">ãªãŠã´ãƒ¼</option>
                        <option value="ãŸã¤ã">ãŸã¤ã</option>
                        <option value="ãƒ€ã‚¤ã‚­ãƒ">ãƒ€ã‚¤ã‚­ãƒ</option>
                    </select>
                </div>

                <div class="alert">
                    <ul>
                        <li>ã‚·ãƒ•ãƒˆå¸Œæœ›ãªã— â†’ ã‚³ãƒ¡ãƒ³ãƒˆã«ã€Œå¸Œæœ›ãªã—ã€ã¨æ›¸ã„ã¦æå‡º</li>
                        <li>ã‚·ãƒ•ãƒˆæå‡ºå¾Œã®ä¿®æ­£ â†’ ãƒ€ã‚¤ã‚­ãƒã®å€‹åˆ¥LINEã¸</li>
                    </ul>
                </div>

                <div class="toc" id="toc-anchor">
                    <h3>ğŸ“‹ ç›®æ¬¡</h3>
                    <ul>
                        <li><a href="#section-1">ï¼‘ï¼éƒ½å¿ƒãƒ–ãƒ­ãƒƒã‚¯â‘ æ–°å®¿å‘¨è¾º</a></li>
                        <li style="padding-left: 20px;"><a href="#section-1-1">ã€æ–°å®¿ã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-1-2">ã€ãƒˆãƒ‹ãƒ¼ãƒ­ãƒ¼ãƒã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-1-3">ã€ç›®é»’ã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-1-4">ã€èŒ—è·è°·ã€‘</a></li>
                        
                        <li><a href="#section-2">ï¼’ï¼éƒ½å¿ƒãƒ–ãƒ­ãƒƒã‚¯â‘¡ãã®ä»–æ±äº¬</a></li>
                        <li style="padding-left: 20px;"><a href="#section-2-1">ã€é–€å‰ä»²ç”º+æœ¨å ´ã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-2-2">ã€é–€å‰ä»²ç”º+æ°´é“æ©‹ã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-2-3">ã€éŒ¦ç³¸ç”ºã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-2-4">ã€è’²ç”°Aã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-2-5">ã€è’²ç”°Bã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-2-6">ã€è’²ç”°æ°´æ›œæ—¥ã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-2-7">ã€èµ¤å‚ã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-2-8">ã€ä¸Šé‡ã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-2-9">ã€å¤§äº•ç”ºã€‘</a></li>
                        
                        <li><a href="#section-3">ï¼“ï¼ç«‹å·ç”ºç”°ãƒ–ãƒ­ãƒƒã‚¯</a></li>
                        <li style="padding-left: 20px;"><a href="#section-3-1">ã€ç«‹å·Aã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-3-2">ã€ç«‹å·Bã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-3-3">ã€å›½ç«‹+æ–°å°å¹³ã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-3-4">ã€ç”ºç”°+å°ç”°æ€¥ç›¸æ¨¡åŸã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-3-5">ã€ç”ºç”°ï¼‹ç™»æˆ¸ã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-3-6">ã€å¤æ·µã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-3-7">ã€æ¨ªæµœé–¢å†…ã€‘</a></li>
                        
                        <li><a href="#section-4">ï¼”ï¼åƒè‘‰åŸ¼ç‰ãƒ›ãƒ¼ãƒ ãƒ–ãƒ­ãƒƒã‚¯</a></li>
                        <li style="padding-left: 20px;"><a href="#section-4-1">ã€å—è¡Œå¾³ã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-4-2">ã€åƒè‘‰ã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-4-3">ã€è¥¿åƒè‘‰ã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-4-4">ã€æ´¥ç”°æ²¼ã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-4-5">ã€èµ¤ç¾½ã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-4-6">ã€æŸè¥¿å£Aã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-4-7">ã€æŸè¥¿å£Bã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-4-8">ã€èˆ¹æ©‹å—å£ã€‘</a></li>
                        <li style="padding-left: 20px;"><a href="#section-4-9">ã€æ–°å°å²©ã€‘</a></li>
                    </ul>
                </div>

                <div id="shift-content">
                    <h2 class="section-title" id="section-1">ï¼‘ï¼éƒ½å¿ƒãƒ–ãƒ­ãƒƒã‚¯â‘ æ–°å®¿å‘¨è¾º</h2>

                    <div class="shift-block" data-days="0,3,5,6" data-extra="19,20">
                        <span class="block-title" id="section-1-1">ã€æ–°å®¿ã€‘</span>
                        <div class="block-description">
                            â—æ²–ç¸„æ–™ç†ä¸€(ã„ã¡)æ–°å®¿åº—<br>
                            â—ç¯‰åœ°æ—¥æœ¬æµ·æ–°å®¿è¥¿å£åº—
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="0,3,5,6,7" data-option="monnaka" data-extra="19,20">
                        <span class="block-title" id="section-1-2">ã€ãƒˆãƒ‹ãƒ¼ãƒ­ãƒ¼ãƒã€‘</span>
                        <div class="block-description">
                            <span class="note-red">âš ï¸é–€å‰ä»²ç”ºã€ã„ã¤ã§ã‚‚è¿½åŠ OK(ï¼‹ï¿¥500)</span><br>
                            â—ãƒˆãƒ‹ãƒ¼ãƒ­ãƒ¼ãƒä¸‰ç•ªç”ºåº—
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="3,5,6" data-extra="19,20">
                        <span class="block-title" id="section-1-3">ã€ç›®é»’ã€‘</span>
                        <div class="block-description">
                            â—åº„ã‚„ ç›®é»’408åº—<br>
                            ãƒ»åšå¤šå¤©ç¥ã‚‚ã¤é‹ãŠå¤šç¦ï¼ˆæ—¥ç¥ä¼‘ï¼‰
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="5,6">
                        <span class="block-title" id="section-1-4">ã€èŒ—è·è°·ã€‘</span>
                        <div class="block-description">
                            â—ç¯‰åœ°æ—¥æœ¬æµ·èŒ—è·è°·<br>
                            â—å¤§ç¿”åœ’
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <h2 class="section-title" id="section-2">ï¼’ï¼éƒ½å¿ƒãƒ–ãƒ­ãƒƒã‚¯â‘¡ãã®ä»–æ±äº¬</h2>

                    <div class="shift-block" data-days="5" data-extra="19,20">
                        <span class="block-title" id="section-2-1">ã€é–€å‰ä»²ç”º+æœ¨å ´ã€‘</span>
                        <div class="block-description">
                            â—åº„ã‚„é–€å‰ä»²ç”ºåº—<br>
                            â—ã¨ã‚‰ã¾ã„ï¼ˆä¸å®šä¼‘ï¼‰<br>
                            â—åº„ã‚„æœ¨å ´åº—<br>
                            â—39Barï¼ˆæœˆä¼‘ã¿ã€ç¥ä¸å®šä¼‘ï¼‰
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="5,6" data-extra="19,20">
                        <span class="block-title" id="section-2-2">ã€é–€å‰ä»²ç”º+æ°´é“æ©‹ã€‘</span>
                        <div class="block-description">
                            â—åº„ã‚„é–€å‰ä»²ç”ºåº—<br>
                            â—åº„ã‚„æ°´é“æ©‹åº—<br>
                            â—ã¨ã‚‰ã¾ã„ï¼ˆä¸å®šä¼‘ï¼‰
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="0,5,6" data-extra="19,20">
                        <span class="block-title" id="section-2-3">ã€éŒ¦ç³¸ç”ºã€‘</span>
                        <div class="block-description">
                            â—åº„ã‚„éŒ¦ç³¸ç”ºåº—<br>
                            â—éŒ¦ç³¸ç”ºæ¨ªä¸<br>
                            ï¼‹ é‡‘åœŸï¼šâ—åº„ã‚„ç¥ç”°æ±å£åº— or ãƒ•ã‚¸ã‚µãƒ³ãƒ‡ãƒª<br>
                            ï¼‹ æ—¥ï¼šâ—åº„ã‚„æ–°å°å²©å—å£åº— or ãƒ•ã‚¸ã‚µãƒ³ãƒ‡ãƒª<br>
                            <span class="note-red">âš ï¸åº„ã‚„ã¨ãƒ•ã‚¸ã‚µãƒ³ãƒ‡ãƒªã©ã¡ã‚‰ã‚’å›ã‚‹ã‹â†’ãƒãƒ©ãƒ³ã‚¹è¦‹ã¦é‹å–¶ãŒæ±ºã‚ã‚‹</span>
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="5,6" data-extra="19,20">
                        <span class="block-title" id="section-2-4">ã€è’²ç”°Aã€‘</span>
                        <div class="block-description">
                            <span class="note-red">âš ï¸ãƒ¯ãƒ«ãƒ³ãƒãƒªâ†’å¤–2ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã¿å®Ÿæ¼”OK</span><br>
                            â—ç¯‰åœ°æ—¥æœ¬æµ·è’²ç”°åº—<br>
                            ãƒ»èŠ±ç«<br>
                            ãƒ»å¤œæ˜ã‘ãœã‚ˆ<br>
                            ãƒ»ãƒŠãƒ³ãƒãƒ¼ãƒ‹ã‚¯<br>
                            ãƒ»ãƒãƒ¼ãƒ’ãƒ­<br>
                            ãƒ»ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ãƒãƒ¼RAPU RAPU<br>
                            ãƒ»å±…é…’å±‹RAPU RAPU<br>
                            ãƒ»ãƒ¯ãƒ«ãƒ³ãƒãƒªï¼ˆå¤–2ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã¿ï¼‰<br>
                            ãƒ»ç¯‰åœ°æ—¥æœ¬æµ·ç³€è°·åº— (å¸Œæœ›è€…ã®ã¿)
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="5,6" data-extra="19,20">
                        <span class="block-title" id="section-2-5">ã€è’²ç”°Bã€‘</span>
                        <div class="block-description">
                            ãƒ»ä¸²å¹¸ (æ—¥ä¼‘)<br>
                            â—ãŠå¥½ã¿ç„¼ãã¨ã—ã¡ã‚ƒã‚“<br>
                            ãƒ»ã¼ã£ã‘ã‚‚ã‚“<br>
                            ãƒ»ãƒ‘ã‚ºãƒªãƒ³ã‚°<br>
                            ãƒ»é­šæµœ<br>
                            ãƒ»ã†ãªãå±‹ï¼ˆç¿”ã€ã¨ã‚“ã®ã¿ï¼‰<br>
                            ãƒ»è±šç•ªé•·<br>
                            ãƒ»è·¯åœ°ä¸€çŒ®â—¯ã¾ã‚‹
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="3">
                        <span class="block-title" id="section-2-6">ã€è’²ç”°æ°´æ›œæ—¥ã€‘</span>
                        <div class="block-description">
                            â—ç¯‰åœ°æ—¥æœ¬æµ·è’²ç”°åº—<br>
                            ãƒ»ä¸²å¹¸<br>
                            ãƒ»å¤œæ˜ã‘ãœã‚ˆ<br>
                            ãƒ»ã¼ã£ã‘ã‚‚ã‚“<br>
                            ãƒ»å±…é…’å±‹RAPU RAPU<br>
                            ãƒ»è±šç•ªé•·<br>
                            â—ãŠå¥½ã¿ç„¼ãã¨ã—ã¡ã‚ƒã‚“
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="3,5">
                        <span class="block-title" id="section-2-7">ã€èµ¤å‚ã€‘</span>
                        <div class="block-description">
                            â—åº„ã‚„èµ¤å‚åº—<br>
                            â—Irish Pub Craic
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="3,5,6" data-extra="19,20">
                        <span class="block-title" id="section-2-8">ã€ä¸Šé‡ã€‘</span>
                        <div class="block-description">
                            <span class="note-red">âš ï¸é‡‘â†’â—æ—¥æœ¬æµ·åº„ã‚„ ä¸Šé‡æµ…è‰å£åº—ã‚‚å›ã‚‹</span><br>
                            â—åº„ã‚„ä¸Šé‡é§…å‰åº—<br>
                            â—ã‚¨ã‚½ãƒ©ä¸Šé‡é§…å‰åº—
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="3,5,6" data-extra="19,20">
                        <span class="block-title" id="section-2-9">ã€å¤§äº•ç”ºã€‘</span>
                        <div class="block-description">
                            ãƒ»å¤§äº•ç”ºãƒãƒ«æ¨ªä¸
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <h2 class="section-title" id="section-3">ï¼“ï¼ç«‹å·ç”ºç”°ãƒ–ãƒ­ãƒƒã‚¯</h2>

                    <div class="shift-block" data-days="0,2,3,5,6" data-extra="19,20">
                        <span class="block-title" id="section-3-1">ã€ç«‹å·Aã€‘</span>
                        <div class="block-description">
                            <span class="note-red">âš ï¸å—å£ã€ãƒãƒ«ãƒŸãƒ¤ã¯è¡Œã‘ã‚‹æ›œæ—¥ã‚’è¶…ï¼ç¢ºèªï¼ãƒŸã‚¹å¤šç™ºï¼</span><br>
                            â—GBç«‹å·åº—<br>
                            â—ã“ã“ã«ã“ã‚“ã­<br>
                            â—ç«‹å·å—å£ï¼ˆæ—¥ã€œæœ¨ï¼‰<br>
                            ãƒ»ãƒ•ãƒ¬ãƒ³ãƒé…’å ´ã“ã¥<br>
                            ãƒ»ãƒãƒ«ãƒŸãƒ¤ï¼ˆæ°´é‡‘åœŸï¼‰<br>
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="3,5,6" data-extra="19,20">
                        <span class="block-title" id="section-3-2">ã€ç«‹å·Bã€‘</span>
                        <div class="block-description">
                            â—åº„ã‚„ç«‹å·å—è«è¨ªé€šã‚Š<br>
                            ãƒ»ãŠã£é­š<br>
                            ãƒ»å’Œæµ·ï¼ˆãªã”ã¿ï¼‰
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="5,6" data-extra="19,20">
                        <span class="block-title" id="section-3-3">ã€å›½ç«‹+æ–°å°å¹³ã€‘</span>
                        <div class="block-description">
                            â—åº„ã‚„å›½ç«‹åº—<br>
                            â—åº„ã‚„æ–°å°å¹³åº—<br>	
                            â—ã‚¯ãƒ©ãƒ•ãƒˆé…’å ´ã‚¯ãƒ‹ã‚¿ãƒã‚«ï¼ˆ1ãƒ»4ãƒ»7ãƒ»10æœˆäºˆå®šã§å„æœˆ1å›ï¼‰	
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="0,3,5,6" data-extra="19,20">
                        <span class="block-title" id="section-3-4">ã€ç”ºç”°+å°ç”°æ€¥ç›¸æ¨¡åŸã€‘</span>
                        <div class="block-description">
                            <span class="note-red">âš ï¸ç”ºç”°ã«ã‚·ãƒ•ãƒˆã‚ã‚Šâ†’ã‚ªãƒ€ã‚µã‚¬ã®ã¿</span><br>
                            â—åº„ã‚„ç”ºç”°æœ¬å®¶åº—<br>
                            â—åº„ã‚„å°ç”°æ€¥ç›¸æ¨¡åŸåº—<br>
                            ãƒ»ManiMani<br>
                            ãƒ»ã„ãã©ã‚“<br>
                            ãƒ»ã¨ã‚Šã„ã¡ãš<br>
                            ãƒ»æ˜æœˆè‹‘ï¼ˆæ°´ä¼‘ã¿ï¼‰<br>
                            ãƒ»ãˆã³ã™<br>
                            ãƒ»ãŠç¥­ã‚Šã•ã£ã¡ã‚ƒã‚“<br><br>
                            ä»¥ä¸‹ã¯ç›´è¿‘ã®å ±å‘Šæ›¸ã‚’è¦‹ã‚‹â†’é€£ç¶šã§å…¥ã‚Šã™ããªã„ã‚ˆã†ã«<br>
                            ãƒ»ã‚¹ãƒŠãƒƒã‚¯ãƒ©ã‚¤ãƒ–ãƒªãƒ¼<br>
                            ãƒ»ã‚­ãƒ£ãƒã‚¯ãƒ©ã‚°ãƒ­ã‚¹<br>
                            ãƒ»ã‚¹ãƒãƒƒãƒˆ<br>
                            ãƒ»ãƒãƒªã‚¢ãƒ³ãƒŠ<br>
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="0,3,5,6" data-extra="19,20">
                        <span class="block-title" id="section-3-5">ã€ç”ºç”°ï¼‹ç™»æˆ¸ã€‘</span>
                        <div class="block-description">
                            â—åº„ã‚„ç”ºç”°æœ¬å®¶åº—<br>
                            â—æ—¥æœ¬æµ·åº„ã‚„ç™»æˆ¸åº—
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    '
                    <div class="shift-block"  data-days="0,3,4.5,6" data-option="kobuchi" data-extra="19,20">
                        <span class="block-title" id="section-3-6">ã€å¤æ·µã€‘</span>
                        <div class="block-description">
                            <span class="note-red">âš ï¸ç™»æˆ¸ã¨ç”ºç”°ã€ã„ã¤ã§ã‚‚è¿½åŠ OK ç™»æˆ¸ã®ã¿(ï¼‹ï¿¥300) ç”ºç”°ã®ã¿(ï¼‹ï¿¥300)</span><br>
                            â—åº„ã‚„å¤æ·µåº—<br>
                            ãƒ»ã¨ã‚Šã„ã¡ãšå¤æ·µåº—
                        </div>
                        <div class="generated-area"></div>
                    </div>
                    '    
                    
                    <div class="shift-block" data-days="0,1,2,3,5,6">
                        <span class="block-title" id="section-3-7">ã€æ¨ªæµœé–¢å†…ã€‘</span>
                        <div class="block-description">
                            <span class="note-red">âš ï¸å¼Šç¤¾ã‹ã‚‰ã®ãƒãƒ¼ã‚¸ãƒ³0å††(ç´¹ä»‹è€…ã®å–ã‚Šåˆ†ã®10%ã®ã¿)</span><br>
                            ãƒ»ã†ã—æ¥µ<br>
                            â—ãƒˆãƒ³ãƒˆã‚¹<br>
                            â—ãƒŸãƒ¤ã‚ªã‚¬ãƒ‘ã‚ª<br>
                            â—ã‚¬ãƒ¼ãƒ«ã‚ºãƒãƒ¼ã•ãã‚‰<br>
                            â—ãƒãƒ¼111<br>
                            ãƒ»ãƒãƒ¼ã‚Šã‚ã‚“<br>
                            ãƒ»é‡‘é­šï¼ˆæœˆï½æœ¨ï¼‰
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <h2 class="section-title" id="section-4">ï¼”ï¼åƒè‘‰åŸ¼ç‰ãƒ›ãƒ¼ãƒ ãƒ–ãƒ­ãƒƒã‚¯</h2>

                    <div class="shift-block" data-days="5,6" data-extra="19,20">
                        <span class="block-title" id="section-4-1">ã€å—è¡Œå¾³ã€‘</span>
                        <div class="block-description">
                            â—åº„ã‚„å—è¡Œå¾³åº—<br>
                            â—ã‚„ã‚‹æ°—é…’å ´ã‚¢ãƒˆãƒ¬æ–°æµ¦å®‰åº—
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="5">
                        <span class="block-title" id="section-4-2">ã€åƒè‘‰ã€‘</span>
                        <div class="block-description">
                            â—ç¯‰åœ°æ—¥æœ¬æµ·åƒè‘‰é§…å‰åº—<br>
                            â—ç¯‰åœ°æ—¥æœ¬æµ·åƒè‘‰ä¸­å¤®åº—
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="5,6" data-extra="19,20">
                        <span class="block-title" id="section-4-3">ã€è¥¿åƒè‘‰ã€‘</span>
                        <div class="block-description">
                            <span class="note-red">âš ï¸åœŸãƒ»æ—¥â†’â—ç¯‰åœ°æ—¥æœ¬æµ·åƒè‘‰ä¸­å¤®åº—ã‚‚å›ã‚‹</span><br>
                            â—åº„ã‚„è¥¿åƒè‘‰åº—<br>
                            â—ãƒ‰ãƒ©ãƒ ç¼¶
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="0,1,2,3,5,6">
                        <span class="block-title" id="section-4-4">ã€æ´¥ç”°æ²¼ã€‘</span>
                        <div class="block-description">
                            â—åº„ã‚„äº¬æˆæ´¥ç”°æ²¼åº—
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="5,6" data-extra="19,20">
                        <span class="block-title" id="section-4-5">ã€èµ¤ç¾½ã€‘</span>
                        <div class="block-description">
                            â—æ—¥æœ¬æµ·åº„ã‚„èµ¤ç¾½è¥¿å£åº—<br>
                            â—åº„ã‚„æœ¬å…«å¹¡åº—<br>
                            â—çµ¶å¥½é³¥
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="3.5,6" data-extra="19,20">
                        <span class="block-title" id="section-4-6">ã€æŸè¥¿å£Aã€‘</span>
                        <div class="block-description">
                            â—åº„ã‚„æŸè¥¿å£åº—<br>
                            â—åº„ã‚„æ–°å…«æŸ±å—å£åº—<br>
                            â—æ—¥æ˜‡
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="3,5,6" data-extra="19,20">
                        <span class="block-title" id="section-4-7">ã€æŸè¥¿å£Bã€‘</span>
                        <div class="block-description">
                            â—åº„ã‚„æŸè¥¿å£åº—<br>
                            â—åº„ã‚„å¢—å°¾åº—<br>
                            â—åº„ã‚„æˆ‘å­«å­åº—
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="5,6" data-extra="19,20">
                        <span class="block-title" id="section-4-8">ã€èˆ¹æ©‹å—å£ã€‘</span>
                        <div class="block-description">
                            â—æ—¥æœ¬æµ·åº„ã‚„èˆ¹æ©‹å—å£åº—<br>
                            â—åº„ã‚„é¦¬è¾¼æ²¢åº—
                        </div>
                        <div class="generated-area"></div>
                    </div>

                    <div class="shift-block" data-days="3">
                        <span class="block-title" id="section-4-9">ã€æ–°å°å²©ã€‘</span>
                        <div class="block-description">
                            â—åº„ã‚„æ–°å°å²©å—å£<br>
                            â—åº„ã‚„æœ¬å…«å¹¡åº—
                        </div>
                        <div class="generated-area"></div>
                    </div>
                </div>

                <div id="page-bottom-anchor"></div>

                <div class="input-group">
                    <label for="commentBox">ã‚³ãƒ¡ãƒ³ãƒˆæ¬„ï¼ˆè‡ªç”±ã«ã”è¨˜è¼‰ãã ã•ã„ï¼‰</label>
                    <textarea id="commentBox" rows="4" placeholder="ã‚·ãƒ•ãƒˆã«é–¢ã™ã‚‹å¸Œæœ›ã‚„é€£çµ¡äº‹é …ãŒã‚ã‚Œã°ã“ã¡ã‚‰ã«ã”è¨˜è¼‰ãã ã•ã„"></textarea>
                </div>

                <div class="button-container">
                    <button id="sendButton" class="action-button">ã‚·ãƒ•ãƒˆæå‡º</button>
                    <button id="confirmButton" class="action-button" disabled>ã‚·ãƒ•ãƒˆç¢ºèªï¼ˆæå‡ºå¾ŒæŠ¼ã›ã¾ã™ï¼‰</button>
                </div>
            </div>
        </div>
    </div>

    <div id="notification"></div>
    <a href="#toc-anchor" id="back-to-toc-btn" class="fixed-button">ç›®æ¬¡ã«æˆ»ã‚‹</a>
    <a href="#page-bottom-anchor" id="submit-shift-btn" class="fixed-button">ä¸€ç•ªä¸‹ã¾ã§ç§»å‹•ã™ã‚‹</a>

    <script>
        // ==================== è¨­å®š ====================
        const CONFIG = {
            YEAR: 2026,
            MONTH: 3,
            HOLIDAYS: [20],
            PRE_HOLIDAYS: [19]
        };

        const GAS_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwmD-V9LWDQ7edPKsUwC9QWszCzJ-JYGT_vQ-nU6S75VnddpsQBRG91c90ZZymi7rP5yg/exec';
        const STORAGE_KEY = `shiftAppData_${CONFIG.YEAR}_${CONFIG.MONTH}V1`;

        // ==================== DOMè¦ç´  ====================
        const DOM = {
            loadingOverlay: document.getElementById('loading-overlay'),
            pageTitle: document.getElementById('page-title-display'),
            mainTextBox: document.getElementById('mainTextBox'),
            commentBox: document.getElementById('commentBox'),
            sendButton: document.getElementById('sendButton'),
            confirmButton: document.getElementById('confirmButton'),
            notification: document.getElementById('notification'),
            shiftContent: document.getElementById('shift-content'),
            submissionResult: document.getElementById('submission-result'),
            shiftInputForm: document.getElementById('shift-input-form'),
            submitShiftBtn: document.getElementById('submit-shift-btn')
        };

        // ==================== ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ====================
        const Utils = {
            showNotification(message, isError = false) {
                DOM.notification.textContent = message;
                DOM.notification.classList.toggle('error', isError);
                DOM.notification.classList.add('show');
                setTimeout(() => DOM.notification.classList.remove('show'), 4000);
            },

            getDaysInMonth() {
                return new Date(CONFIG.YEAR, CONFIG.MONTH, 0).getDate();
            },

            getDayLabel(dayIndex) {
                const days = ["æ—¥", "æœˆ", "ç«", "æ°´", "æœ¨", "é‡‘", "åœŸ"];
                return days[dayIndex];
            },

            formatDateText(day, dayIndex) {
                let dayLabel = this.getDayLabel(dayIndex);
                let suffix = "";
                
                if (CONFIG.HOLIDAYS.includes(day)) {
                    suffix += "ç¥";
                } else if (CONFIG.PRE_HOLIDAYS.includes(day)) {
                    suffix += "ç¥å‰";
                }
                
                return `${day}${dayLabel}${suffix}`;
            }
        };

        // ==================== ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç”Ÿæˆ ====================
        const CalendarGenerator = {
            generate() {
                const daysInMonth = Utils.getDaysInMonth();
                
                document.querySelectorAll('.shift-block').forEach(block => {
                    const allowedDays = this.getAllowedDays(block);
                    const extraDates = this.getExtraDates(block);
                    const optionType = block.getAttribute('data-option');
                    
                    const batchButtons = this.createBatchButtons(daysInMonth, allowedDays, extraDates);
                    const dateLines = this.createDateLines(daysInMonth, allowedDays, extraDates, optionType);
                    
                    block.querySelector('.generated-area').innerHTML = batchButtons + dateLines;
                });
            },

            getAllowedDays(block) {
                const daysStr = block.getAttribute('data-days') || "";
                return daysStr.split(',').map(Number);
            },

            getExtraDates(block) {
                const extraStr = block.getAttribute('data-extra') || "";
                return extraStr ? extraStr.split(',').map(Number) : [];
            },

            createBatchButtons(daysInMonth, allowedDays, extraDates) {
                const daysFound = new Set();
                
                for (let d = 1; d <= daysInMonth; d++) {
                    const dateObj = new Date(CONFIG.YEAR, CONFIG.MONTH - 1, d);
                    const dayIdx = dateObj.getDay();
                    if (allowedDays.includes(dayIdx) || extraDates.includes(d)) {
                        daysFound.add(dayIdx);
                    }
                }

                let html = '<div class="batch-select-container">';
                [1, 2, 3, 4, 5, 6, 0].forEach(dIdx => {
                    if (daysFound.has(dIdx)) {
                        const dayChar = Utils.getDayLabel(dIdx);
                        html += `<button class="batch-select-btn" data-day="${dayChar}">${dayChar}ä¸€æ‹¬</button>`;
                    }
                });
                html += '</div>';
                
                return html;
            },

            createDateLines(daysInMonth, allowedDays, extraDates, optionType) {
             let html = '';
            
        for (let d = 1; d <= daysInMonth; d++) {
        const dateObj = new Date(CONFIG.YEAR, CONFIG.MONTH - 1, d);
        const dayIdx = dateObj.getDay();
        
        if (allowedDays.includes(dayIdx) || extraDates.includes(d)) {
            const dateText = Utils.formatDateText(d, dayIdx);
            let optionHtml = '';
            
            if (optionType === 'monnaka') {
                optionHtml = '<span class="secondary-option disabled">é–€å‰ä»²ç”ºã‚‚è¿½åŠ </span>';
            } else if (optionType === 'kobuchi') {
                optionHtml = '<span class="secondary-option disabled">ç™»æˆ¸ã‚’è¿½åŠ </span><span class="secondary-option disabled">ç”ºç”°ã‚’è¿½åŠ </span>';
            }
            
            html += `
                <div class="shift-line" data-date="${d}">
                    <span class="date-entry">${dateText}</span>
                    ${optionHtml}
                    ï½œ
                    <span class="assignee"></span>
                    <span class="appended-text"></span>
                </div>
            `;
        }
    }
    
    return html;
}
        };

        // ==================== ã‚·ãƒ•ãƒˆé¸æŠ ====================
        const ShiftSelector = {
            toggleSelection(dateEntry) {
                const name = DOM.mainTextBox.value;
                const parent = dateEntry.parentElement;
                const assigneeSpan = parent.querySelector('.assignee');
                const secondaryOptions = parent.querySelectorAll('.secondary-option');
                
                if (dateEntry.classList.contains('selected')) {
                    dateEntry.classList.remove('selected');
                    assigneeSpan.textContent = '';
                    secondaryOptions.forEach(opt => {
                        opt.classList.remove('selected');
                        opt.classList.add('disabled');
                    });
                    parent.querySelector('.appended-text').textContent = '';
                } else {
                    if (!name) {
                        Utils.showNotification('å…ˆã«ãƒã‚¸ã‚·ãƒ£ãƒ³åã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚', true);
                        return;
                    }
                    dateEntry.classList.add('selected');
                    assigneeSpan.textContent = name;
                    secondaryOptions.forEach(opt => opt.classList.remove('disabled'));
                }
            },

            toggleSecondaryOption(option) {
    if (option.classList.contains('disabled')) return;
    
    const appendedTextSpan = option.parentElement.querySelector('.appended-text');
    const textToAdd = option.innerText;
    let formattedText;
    
    if (textToAdd === 'é–€å‰ä»²ç”ºã‚‚è¿½åŠ ') {
        formattedText = 'ï¼ˆï¼‹é–€å‰ä»²ç”ºï¼‰';
    } else if (textToAdd === 'ç™»æˆ¸ã‚’è¿½åŠ ') {
        formattedText = 'ï¼ˆï¼‹ç™»æˆ¸ï¼‰';
    } else if (textToAdd === 'ç”ºç”°ã‚’è¿½åŠ ') {
        formattedText = 'ï¼ˆï¼‹ç”ºç”°ï¼‰';
    } else {
        formattedText = `ï¼ˆ${textToAdd}ï¼‰`;
    }

    if (option.classList.contains('selected')) {
        option.classList.remove('selected');
        appendedTextSpan.textContent = appendedTextSpan.textContent.replace(formattedText, '').trim();
    } else {
        option.classList.add('selected');
        appendedTextSpan.textContent = (appendedTextSpan.textContent + ' ' + formattedText).trim();
    }
},

            batchSelect(shiftBlock, dayChar) {
                const name = DOM.mainTextBox.value;
                if (!name) {
                    Utils.showNotification('å…ˆã«ãƒã‚¸ã‚·ãƒ£ãƒ³åã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚', true);
                    return;
                }
                
                const targetEntries = Array.from(shiftBlock.querySelectorAll('.date-entry'))
                    .filter(el => el.innerText.includes(dayChar));

                if (targetEntries.length === 0) return;
                
                const isAllSelected = targetEntries.every(el => el.classList.contains('selected'));

                targetEntries.forEach(dateEntry => {
                    if (isAllSelected) {
                        if (dateEntry.classList.contains('selected')) {
                            this.toggleSelection(dateEntry);
                        }
                    } else {
                        if (!dateEntry.classList.contains('selected')) {
                            this.toggleSelection(dateEntry);
                        }
                    }
                });
                
                StorageManager.save();
            },

            updateAllAssigneeNames() {
                const newName = DOM.mainTextBox.value;
                document.querySelectorAll('.date-entry.selected').forEach(selectedDate => {
                    selectedDate.parentElement.querySelector('.assignee').textContent = newName;
                });
            }
        };

        // ==================== ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç®¡ç† ====================
        const StorageManager = {
            save(forceSubmittedState = null, submittedPayload = null) {
                const isAlreadySubmitted = this.isSubmitted();
                
                const data = {
                    magicianName: DOM.mainTextBox.value,
                    comment: DOM.commentBox.value,
                    selections: this.getSelections(),
                    submitted: forceSubmittedState !== null ? forceSubmittedState : isAlreadySubmitted,
                    submittedPayload: submittedPayload
                };

                const item = {
                    value: data,
                    expiry: new Date().getTime() + (45 * 24 * 60 * 60 * 1000)
                };
                
                localStorage.setItem(STORAGE_KEY, JSON.stringify(item));
            },

            load() {
                const itemStr = localStorage.getItem(STORAGE_KEY);
                if (!itemStr) return null;

                try {
                    const item = JSON.parse(itemStr);
                    if (!item || !item.expiry || !item.value || new Date().getTime() > item.expiry) {
                        localStorage.removeItem(STORAGE_KEY);
                        return null;
                    }
                    return item.value;
                } catch (e) {
                    localStorage.removeItem(STORAGE_KEY);
                    return null;
                }
            },

            getSelections() {
                const selections = [];
                document.querySelectorAll('.shift-line').forEach((line, index) => {
                    const dateEntry = line.querySelector('.date-entry');
                    if (dateEntry && dateEntry.classList.contains('selected')) {
                        const secondaryOptions = [];
                        line.querySelectorAll('.secondary-option.selected').forEach(opt => {
                            secondaryOptions.push(opt.innerText);
                        });
                        selections.push({ lineIndex: index, options: secondaryOptions });
                    }
                });
                return selections;
            },

            isSubmitted() {
                const itemStr = localStorage.getItem(STORAGE_KEY);
                if (!itemStr) return false;
                try {
                    const item = JSON.parse(itemStr);
                    return item?.value?.submitted || false;
                } catch (e) {
                    return false;
                }
            }
        };

        // ==================== ãƒ‡ãƒ¼ã‚¿é€ä¿¡ ====================
        const DataSubmitter = {
            async submit() {
                if (!confirm('ã‚·ãƒ•ãƒˆã‚’æå‡ºã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) return;

                if (!DOM.mainTextBox.value) {
                    Utils.showNotification('ãƒã‚¸ã‚·ãƒ£ãƒ³åã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚', true);
                    return;
                }

                const payload = this.buildPayload();
                this.setSubmittingState();

                try {
                    const response = await fetch(GAS_WEB_APP_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                        body: JSON.stringify(payload)
                    });

                    const data = await response.json();

                    if (data.status === 'success') {
                        this.handleSuccess(payload);
                    } else {
                        this.handleError(data.message);
                    }
                } catch (error) {
                    console.error('é€ä¿¡ã‚¨ãƒ©ãƒ¼:', error);
                    this.handleError('é€ä¿¡ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚');
                } finally {
                    DOM.loadingOverlay.style.display = 'none';
                }
            },

            buildPayload() {
                const comment = DOM.commentBox.value.trim();
                const payload = [];

                document.querySelectorAll('.shift-block').forEach(block => {
                    const blockTitleEl = block.querySelector('.block-title');
                    if (!blockTitleEl) return;

                    const storeName = blockTitleEl.innerText.trim();

                    block.querySelectorAll('.shift-line').forEach(line => {
                        const assigneeSpan = line.querySelector('.assignee');
                        if (assigneeSpan && assigneeSpan.innerText.trim()) {
                            const dateText = line.querySelector('.date-entry').innerText;
                            let appendedText = '';
                            const appendedEl = line.querySelector('.appended-text');
                            if (appendedEl && appendedEl.innerText) {
                                appendedText = ' ' + appendedEl.innerText;
                            }
                            payload.push({
                                store: storeName,
                                date: dateText,
                                value: assigneeSpan.innerText + appendedText,
                                comment: comment
                            });
                        }
                    });
                });

                if (payload.length === 0) {
                    payload.push({
                        store: '',
                        date: '',
                        value: DOM.mainTextBox.value,
                        comment: comment
                    });
                }

                return payload;
            },

            setSubmittingState() {
                DOM.sendButton.disabled = true;
                DOM.sendButton.textContent = 'é€ä¿¡ä¸­...';
                DOM.submitShiftBtn.style.display = 'none';
                DOM.loadingOverlay.style.display = 'flex';
            },

            handleSuccess(payload) {
                Utils.showNotification('ã‚·ãƒ•ãƒˆæå‡ºãŒå®Œäº†ã—ã¾ã—ãŸã€‚', false);
                DOM.sendButton.textContent = 'æå‡ºæ¸ˆã¿';
                DOM.confirmButton.disabled = false;
                StorageManager.save(true, payload);
                ResultDisplay.show(payload);
            },

            handleError(message) {
                Utils.showNotification(`é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ: ${message || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'}`, true);
                DOM.sendButton.disabled = false;
                DOM.sendButton.textContent = 'ã‚·ãƒ•ãƒˆæå‡º';
                DOM.submitShiftBtn.style.display = 'block';
            }
        };

        // ==================== çµæœè¡¨ç¤º ====================
        const ResultDisplay = {
            show(payload) {
                DOM.submissionResult.style.display = 'block';
                
                // å…¥åŠ›ã‚’ç„¡åŠ¹åŒ–
                DOM.mainTextBox.disabled = true;
                DOM.commentBox.disabled = true;
                document.querySelectorAll('.date-entry').forEach(el => el.style.pointerEvents = 'none');
                document.querySelectorAll('.secondary-option').forEach(el => el.style.pointerEvents = 'none');
                document.querySelectorAll('.batch-select-btn').forEach(btn => btn.disabled = true);

                const magicianName = payload[0].value.split(' ')[0];
                const comment = payload[0].comment;

                document.getElementById('result-magician-name').textContent = magicianName;

                const shiftsByStore = this.groupShiftsByStore(payload, magicianName);
                this.renderShiftsList(shiftsByStore);
                this.renderComment(comment);
            },

            groupShiftsByStore(payload, magicianName) {
                return payload.reduce((acc, shift) => {
                    if (!shift.store) return acc;
                    if (!acc[shift.store]) acc[shift.store] = [];
                    acc[shift.store].push(`${shift.date}${shift.value.replace(magicianName, '').trim()}`);
                    return acc;
                }, {});
            },

            renderShiftsList(shiftsByStore) {
                let html = '<ul>';
                for (const store in shiftsByStore) {
                    html += `<li><h4>${store}</h4>${shiftsByStore[store].join('ã€ ')}</li>`;
                }
                html += '</ul>';
                document.getElementById('result-shifts-list').innerHTML = html;
            },

            renderComment(comment) {
                if (comment && comment.trim()) {
                    document.getElementById('result-comment-area').style.display = 'block';
                    document.getElementById('result-comment').textContent = comment;
                }
            }
        };

        // ==================== ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ ====================
        const ClipboardManager = {
            async copyShifts() {
                const magicianName = DOM.mainTextBox.value;
                if (!magicianName) {
                    Utils.showNotification('ãƒã‚¸ã‚·ãƒ£ãƒ³åãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚', true);
                    return;
                }

                let clipboardText = `${CONFIG.MONTH}æœˆ æå‡ºã‚·ãƒ•ãƒˆ\n\n`;
                const shiftsByStore = this.getShiftsByStore();

                if (shiftsByStore.size === 0) {
                    Utils.showNotification('ã‚³ãƒ”ãƒ¼ã™ã‚‹ã‚·ãƒ•ãƒˆãŒã‚ã‚Šã¾ã›ã‚“ã€‚', true);
                    return;
                }

                shiftsByStore.forEach((dates, store) => {
                    clipboardText += `${store}\n`;
                    clipboardText += dates.join(', ') + '\n\n';
                });

                try {
                    await navigator.clipboard.writeText(clipboardText.trim());
                    Utils.showNotification('æå‡ºã‚·ãƒ•ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€‚', false);
                } catch (err) {
                    Utils.showNotification('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚', true);
                }
            },

            getShiftsByStore() {
                const shiftsByStore = new Map();
                
                document.querySelectorAll('.shift-block').forEach(block => {
                    const storeName = block.querySelector('.block-title').innerText.trim();
                    let datesForStore = [];
                    
                    block.querySelectorAll('.shift-line').forEach(line => {
                        const assigneeSpan = line.querySelector('.assignee');
                        if (assigneeSpan && assigneeSpan.innerText.trim()) {
                            const dateText = line.querySelector('.date-entry').innerText;
                            datesForStore.push(dateText);
                        }
                    });
                    
                    if (datesForStore.length > 0) {
                        if (!shiftsByStore.has(storeName)) {
                            shiftsByStore.set(storeName, []);
                        }
                        shiftsByStore.get(storeName).push(...datesForStore);
                    }
                });
                
                return shiftsByStore;
            }
        };

        // ==================== ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ ====================
        const EventListeners = {
            setup() {
                if (!StorageManager.isSubmitted()) {
                    DOM.shiftContent.addEventListener('click', (e) => {
                        if (e.target.classList.contains('date-entry')) {
                            ShiftSelector.toggleSelection(e.target);
                            StorageManager.save();
                        }
                        
                        if (e.target.classList.contains('secondary-option')) {
                            ShiftSelector.toggleSecondaryOption(e.target);
                            StorageManager.save();
                        }
                        
                        if (e.target.classList.contains('batch-select-btn')) {
                            const day = e.target.getAttribute('data-day');
                            const shiftBlock = e.target.closest('.shift-block');
                            ShiftSelector.batchSelect(shiftBlock, day);
                        }
                    });

                    DOM.mainTextBox.addEventListener('change', () => {
                        ShiftSelector.updateAllAssigneeNames();
                        StorageManager.save();
                    });

                    DOM.commentBox.addEventListener('input', () => StorageManager.save());
                    DOM.sendButton.addEventListener('click', () => DataSubmitter.submit());
                }

                DOM.confirmButton.addEventListener('click', () => ClipboardManager.copyShifts());
            }
        };

        // ==================== åˆæœŸåŒ– ====================
        const App = {
            init() {
                DOM.pageTitle.textContent = `${CONFIG.YEAR}å¹´${CONFIG.MONTH}æœˆã‚·ãƒ•ãƒˆ`;
                CalendarGenerator.generate();
                this.loadSavedData();
                EventListeners.setup();
            },

            loadSavedData() {
                const data = StorageManager.load();
                if (!data) return;

                if (data.submitted && data.submittedPayload) {
                    ResultDisplay.show(data.submittedPayload);
                }

                if (data.submitted) {
                    DOM.sendButton.disabled = true;
                    DOM.sendButton.textContent = 'æå‡ºæ¸ˆã¿';
                    DOM.confirmButton.disabled = false;
                }

                DOM.mainTextBox.value = data.magicianName || '';
                DOM.commentBox.value = data.comment || '';

                if (Array.isArray(data.selections)) {
                    const allLines = document.querySelectorAll('.shift-line');
                    data.selections.forEach(sel => {
                        const line = allLines[sel.lineIndex];
                        if (line) {
                            const dateEntry = line.querySelector('.date-entry');
                            if (dateEntry) {
                                dateEntry.classList.add('selected');
                                line.querySelector('.assignee').textContent = data.magicianName;
                                
                                const secondaryOpts = line.querySelectorAll('.secondary-option');
                                secondaryOpts.forEach(opt => opt.classList.remove('disabled'));

                                let appendedText = '';
secondaryOpts.forEach(opt => {
    if (sel.options && sel.options.includes(opt.innerText)) {
        opt.classList.add('selected');
        let textToAdd = opt.innerText;
        let formattedText;
        
        if (textToAdd === 'é–€å‰ä»²ç”ºã‚‚è¿½åŠ ') {
            formattedText = 'ï¼ˆï¼‹é–€å‰ä»²ç”ºï¼‰';
        } else if (textToAdd === 'ç™»æˆ¸ã‚’è¿½åŠ ') {
            formattedText = 'ï¼ˆï¼‹ç™»æˆ¸ï¼‰';
        } else if (textToAdd === 'ç”ºç”°ã‚’è¿½åŠ ') {
            formattedText = 'ï¼ˆï¼‹ç”ºç”°ï¼‰';
        } else {
            formattedText = `ï¼ˆ${textToAdd}ï¼‰`;
        }
        
        appendedText += formattedText + ' ';
    }
                                });
                                line.querySelector('.appended-text').textContent = appendedText.trim();
                            }
                        }
                    });
                }
            }
        };

        // ==================== èµ·å‹• ====================
        document.addEventListener('DOMContentLoaded', () => App.init());
    </script>
</body>
</html>
