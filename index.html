<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>シフト入力補助アプリ</title>
    <style>
        /* 基本的なスタイル */
        html { scroll-behavior: smooth; } /* ページ内ジャンプを滑らかにする */
        body {
            font-family: sans-serif; padding: 20px;
            line-height: 1.8; margin-bottom: 100px;
        }
        .container {
            max-width: 700px; margin: 0 auto; border: 1px solid #ccc;
            padding: 25px; border-radius: 8px;
        }
        .input-group { margin-bottom: 20px; }
        .input-group label { font-weight: bold; margin-right: 10px; }
        #mainTextBox {
            padding: 8px; width: 200px; border: 1px solid #ccc; border-radius: 4px;
        }
        .shift-block { margin-top: 25px; }
        .block-title { font-size: 1.2em; font-weight: bold; }
        .shift-line { display: flex; align-items: center; flex-wrap: wrap; }
        .date-entry {
            cursor: pointer; padding: 2px 5px; border-radius: 3px;
            transition: background-color 0.2s;
        }
        .date-entry.selected { background-color: #fffacd; }
        .assignee { color: #d9534f; font-weight: bold; margin: 0 5px; }

        /* --- ▼ここから追加・変更したCSS▼ --- */
        .page-title { text-align: center; margin-bottom: 25px; }
        .section-title {
            font-size: 1.5em; margin-top: 40px; padding-bottom: 5px;
            border-bottom: 2px solid #0056b3;
        }
        .toc {
            margin-bottom: 25px; padding: 15px; background-color: #f8f9fa;
            border: 1px solid #dee2e6; border-radius: 5px;
        }
        .toc h3 { margin-top: 0; }
        .toc ul { list-style-type: none; padding-left: 0; margin-bottom: 0; }
        .toc li { margin-bottom: 5px; }
        .toc a { text-decoration: none; color: #0056b3; font-weight: bold; }
        .toc a:hover { text-decoration: underline; }
        .note-red { color: #dc3545; font-weight: bold; }
        
        .date-entry.conflicting-disabled {
            color: #bbb;
            cursor: not-allowed;
            text-decoration: line-through;
            background-color: #f2f2f2;
        }
        
        .scroll-button-wrapper {
            text-align: right;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        .scroll-button {
            display: inline-block;
            padding: 8px 16px;
            background-color: #6c757d;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 0.9em;
            transition: background-color 0.2s;
        }
        .scroll-button:hover {
            background-color: #5a6268;
        }
        .scroll-button + .scroll-button {
            margin-left: 8px;
        }

        /* --- ▲ここまで追加・変更したCSS▲ --- */

        .secondary-option {
            margin-left: 8px; padding: 2px 5px; border-radius: 3px;
            transition: background-color 0.2s, color 0.2s; cursor: pointer;
        }
        .secondary-option.disabled { color: #aaa; cursor: not-allowed; background-color: transparent; }
        .secondary-option.selected { background-color: #d4edda; color: #155724; }
        .appended-text { color: #155724; font-weight: bold; margin-left: 8px; }

        .button-container { text-align: center; margin-top: 30px; }
        #copyButton, #resetButton {
            padding: 12px 25px; font-size: 1.1em; cursor: pointer;
            color: white; border: none;
            border-radius: 5px; transition: background-color 0.2s;
        }
        #copyButton { background-color: #007bff; margin-right: 10px; }
        #copyButton:hover { background-color: #0056b3; }
        
        #resetButton { background-color: #dc3545; }
        #resetButton:hover { background-color: #c82333; }
        
        #notification {
            position: fixed; bottom: 20px; left: 50%;
            transform: translateX(-50%); background-color: #28a745;
            color: white; padding: 12px 22px; border-radius: 5px;
            z-index: 1000; opacity: 0;
            transition: opacity 0.5s ease-in-out; pointer-events: none;
        }
        #notification.show { opacity: 1; }
    </style>
</head>
<body>

<div class="container">
    <h1 class="page-title">2025年9月シフト提出</h1>
    <div class="input-group">
        <label for="mainTextBox">マジシャン名（最初に必ず入力してください）</label>
        <input type="text" id="mainTextBox" placeholder="ここに名前を入力">
    </div>

    <p class="note-red" style="margin-top: -10px; margin-bottom: 20px;">
        すべてのシフト入力が完了したら、ページ一番下の「コピー」ボタンを押し、<br>〇〇の部屋に張り付けて送信してください。
    </p>

    <div class="toc" id="toc-anchor">
        <h3>目次</h3>
        <ul>
            <li><a href="#section-1">１．都心ブロック①新宿周辺</a></li>
            <li><a href="#section-2">２．都心ブロック②その他東京</a></li>
            <li><a href="#section-3">３．立川町田ブロック</a></li>
            <li><a href="#section-4">４．千葉埼玉ホームブロック</a></li>
        </ul>
    </div>
    <hr>
    
    <div id="shift-content">
        <h2 class="section-title" id="section-1">１．都心ブロック①新宿周辺</h2>
        <div class="shift-block">
            <p><span class="block-title">【新宿】</span><br>◎沖縄料理一(いち)新宿店<br>◎築地日本海新宿西口店<br>水、金、土、祝、祝前</p>
            <div class="shift-line"><span class="date-entry">3水</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">5金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">6土</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">10水</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">12金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">13土</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">14日祝前</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">15月祝</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">17水</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">19金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">20土</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">22月祝前</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">23火祝</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">24水</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">26金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">27土</span>｜<span class="assignee"></span></div>
        </div>
        <div class="shift-block">
            <p><span class="block-title">【トニーローマ】</span><br>◎トニーローマ三番町店<br>水、金、土、日、祝、祝前</p>
            <div class="shift-line"><span class="date-entry">3水</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">5金</span><span class="secondary-option disabled">門前仲町も希望</span>｜<span class="assignee"></span><span class="appended-text"></span></div>
            <div class="shift-line"><span class="date-entry">6土</span><span class="secondary-option disabled">門前仲町も希望</span>｜<span class="assignee"></span><span class="appended-text"></span></div>
            <div class="shift-line"><span class="date-entry">7日</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">10水</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">12金</span><span class="secondary-option disabled">門前仲町も希望</span>｜<span class="assignee"></span><span class="appended-text"></span></div>
            <div class="shift-line"><span class="date-entry">13土</span><span class="secondary-option disabled">門前仲町も希望</span>｜<span class="assignee"></span><span class="appended-text"></span></div>
            <div class="shift-line"><span class="date-entry">14日祝前</span><span class="secondary-option disabled">門前仲町も希望</span>｜<span class="assignee"></span><span class="appended-text"></span></div>
            <div class="shift-line"><span class="date-entry">15月祝</span><span class="secondary-option disabled">門前仲町も希望</span>｜<span class="assignee"></span><span class="appended-text"></span></div>
            <div class="shift-line"><span class="date-entry">17日</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">19金</span><span class="secondary-option disabled">門前仲町も希望</span>｜<span class="assignee"></span><span class="appended-text"></span></div>
            <div class="shift-line"><span class="date-entry">20土</span><span class="secondary-option disabled">門前仲町も希望</span>｜<span class="assignee"></span><span class="appended-text"></span></div>
            <div class="shift-line"><span class="date-entry">21日</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">22月祝前</span><span class="secondary-option disabled">門前仲町も希望</span>｜<span class="assignee"></span><span class="appended-text"></span></div>
            <div class="shift-line"><span class="date-entry">23火祝</span><span class="secondary-option disabled">門前仲町も希望</span>｜<span class="assignee"></span><span class="appended-text"></span></div>
            <div class="shift-line"><span class="date-entry">24水</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">26金</span><span class="secondary-option disabled">門前仲町も希望</span>｜<span class="assignee"></span><span class="appended-text"></span></div>
            <div class="shift-line"><span class="date-entry">27土</span><span class="secondary-option disabled">門前仲町も希望</span>｜<span class="assignee"></span><span class="appended-text"></span></div>
            <div class="shift-line"><span class="date-entry">28日</span>｜<span class="assignee"></span></div>
        </div>
        <div class="shift-block">
            <p><span class="block-title">【目黒】</span><br>◎庄や 目黒408店<br>・博多天神もつ鍋お多福<br>水、金、土、祝、祝前</p>
            <div class="shift-line"><span class="date-entry">3水</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">5金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">6土</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">10水</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">12金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">13土</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">14日祝前</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">15月祝</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">17水</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">19金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">20土</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">22月祝前</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">23火祝</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">24水</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">26金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">27土</span>｜<span class="assignee"></span></div>
        </div>
        <div class="shift-block">
            <p><span class="block-title">【茗荷谷】</span><br>◎築地日本海茗荷谷店<br>◎大翔園<br>金、土</p>
            <div class="shift-line"><span class="date-entry">5金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">6土</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">12金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">13土</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">19金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">20土</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">26金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">27土</span>｜<span class="assignee"></span></div>
        </div>
        <div class="scroll-button-wrapper">
            <a href="#toc-anchor" class="scroll-button">目次に戻る</a>
            <a href="#page-bottom-anchor" class="scroll-button">一番下まで移動する</a>
        </div>
        <h2 class="section-title" id="section-2">２．都心ブロック②その他東京</h2>
        <div class="shift-block" id="machida-noborito-block">
            <p><span class="block-title">【町田＋登戸】</span><br>◎庄や町田本家店<br>・エソラ町田駅前店<br>◎日本海庄や登戸店<br>金、土、祝、祝前</p>
            <div class="shift-line"><span class="date-entry">5金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">6土</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">12金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">13土</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">14日祝前</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">15月祝</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">19金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">20土</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">22月祝前</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">23火祝</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">26金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">27土</span>｜<span class="assignee"></span></div>
        </div>
        <div class="shift-block">
            <p><span class="block-title">【横浜関内】</span><br>・うし極<br>◎トントス<br>◎ミヤオガパオ<br>◎ガールズバーさくら<br>◎バー111<br>・バーりあん<br>・金魚（月～木）未定<br>金、土、祝、祝前</p>
            <div class="shift-line"><span class="date-entry">5金</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">6土</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">12金</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">13土</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">14日祝前</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">15月祝</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">19金</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">20土</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">22月祝前</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">23火祝</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">26金</span>｜<span class="assignee"></span></div>
            <div class="shift-line"><span class="date-entry">27土</span>｜<span class="assignee"></span></div>
        </div>
        <div class="scroll-button-wrapper">
            <a href="#toc-anchor" class="scroll-button">目次に戻る</a>
            <a href="#page-bottom-anchor" class="scroll-button">一番下まで移動する</a>
        </div>
        <h2 class="section-title" id="section-4">４．千葉埼玉ホームブロック</h2>
        <div class="shift-block">
            <p><span class="block-title">【船橋南口】</span><br>・日本海庄や船橋南口店<br>・庄や馬込沢店<br>金、土、祝、祝前</p>
            <div class="shift-line"><span class="date-entry">5金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">6土</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">12金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">13土</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">14日祝前</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">15月祝</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">19金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">20土</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">22月祝前</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">23火祝</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">26金</span>｜<span class="assignee"></span></div><div class="shift-line"><span class="date-entry">27土</span>｜<span class="assignee"></span></div>
        </div>
    </div>
    <div class="scroll-button-wrapper" style="text-align: center;">
        <a href="#toc-anchor" class="scroll-button">目次に戻る</a>
    </div>

    <div id="page-bottom-anchor"></div>

    <div class="button-container">
        <button id="copyButton">コピー（選択した店舗のみ）</button>
        <button id="resetButton">リセット</button>
    </div>
</div>

<div id="notification">内容をコピーしました</div>

<script>
// LocalStorageのキーを定義
const STORAGE_KEY = 'shiftAppData_2025_09';

// --- 初期化処理 ---
document.addEventListener('DOMContentLoaded', function() {
    loadData();

    document.querySelectorAll('.date-entry').forEach(el => {
        el.addEventListener('click', () => {
            toggleSelection(el);
            saveData();
        });
    });

    document.querySelectorAll('.secondary-option').forEach(el => {
        el.addEventListener('click', () => {
            toggleSecondaryOption(el);
            saveData();
        });
    });
    
    document.getElementById('mainTextBox').addEventListener('input', saveData);

    document.getElementById('copyButton').addEventListener('click', copyContentToClipboard);
    document.getElementById('resetButton').addEventListener('click', resetAll);
});

// --- データ保存/復元/リセット機能 ---

// ▼▼▼【！】ここを修正▼▼▼
function saveData() {
    const data = {
        magicianName: document.getElementById('mainTextBox').value,
        selections: []
    };

    document.querySelectorAll('.shift-line').forEach((line, index) => {
        const dateEntry = line.querySelector('.date-entry');
        if (dateEntry && dateEntry.classList.contains('selected')) {
            const secondaryOptions = [];
            line.querySelectorAll('.secondary-option.selected').forEach(opt => {
                secondaryOptions.push(opt.innerText);
            });
            data.selections.push({
                lineIndex: index,
                options: secondaryOptions
            });
        }
    });

    const now = new Date();
    // 10日後のタイムスタンプを有効期限として設定
    const expiry = now.getTime() + (10 * 24 * 60 * 60 * 1000);

    const item = {
        value: data,
        expiry: expiry,
    };

    localStorage.setItem(STORAGE_KEY, JSON.stringify(item));
}

// ▼▼▼【！】ここを修正▼▼▼
function loadData() {
    const itemStr = localStorage.getItem(STORAGE_KEY);
    if (!itemStr) {
        return;
    }

    const item = JSON.parse(itemStr);
    const now = new Date();

    // 有効期限をチェック
    if (now.getTime() > item.expiry) {
        // 期限切れならデータを削除して終了
        localStorage.removeItem(STORAGE_KEY);
        return;
    }

    const data = item.value; // 有効期限内のデータ本体
    const name = data.magicianName || '';
    
    document.getElementById('mainTextBox').value = name;

    const allLines = document.querySelectorAll('.shift-line');
    if (data.selections) {
        data.selections.forEach(sel => {
            const line = allLines[sel.lineIndex];
            if (line) {
                const dateEntry = line.querySelector('.date-entry');
                if (dateEntry) {
                    dateEntry.classList.add('selected');
                    line.querySelector('.assignee').textContent = name;
                    
                    const secondaryOpts = line.querySelectorAll('.secondary-option');
                    secondaryOpts.forEach(opt => opt.classList.remove('disabled'));

                    if (sel.options && sel.options.length > 0) {
                        let appendedText = '';
                        secondaryOpts.forEach(opt => {
                            if (sel.options.includes(opt.innerText)) {
                                opt.classList.add('selected');
                                appendedText += `（${opt.innerText}） `;
                            }
                        });
                        line.querySelector('.appended-text').textContent = appendedText.trim();
                    }
                }
            }
        });
    }
    updateAllMachidaConflicts();
}
// ▲▲▲【！】ここまで修正▲▲▲


function resetAll() {
    if (confirm('入力内容をすべてリセットします。よろしいですか？')) {
        localStorage.removeItem(STORAGE_KEY);
        location.reload();
    }
}

// --- 既存の機能 ---

function updateAllMachidaConflicts() {
    document.querySelectorAll('#machida-sagamihara-block .date-entry, #machida-noborito-block .date-entry').forEach(el => {
        if (el.classList.contains('selected')) {
            updateMachidaConflict(el, true);
        }
    });
}

function updateMachidaConflict(clickedElement, isSelecting) {
    const dateText = clickedElement.innerText;
    const parentBlock = clickedElement.closest('.shift-block');
    if (!parentBlock) return;

    let otherBlockId;
    if (parentBlock.id === 'machida-sagamihara-block') {
        otherBlockId = 'machida-noborito-block';
    } else if (parentBlock.id === 'machida-noborito-block') {
        otherBlockId = 'machida-sagamihara-block';
    } else {
        return; 
    }

    const otherBlock = document.getElementById(otherBlockId);
    if (!otherBlock) return;

    const otherDateElements = otherBlock.querySelectorAll('.date-entry');
    const targetElement = Array.from(otherDateElements).find(el => el.innerText === dateText);

    if (targetElement) {
        if (isSelecting) {
            targetElement.classList.add('conflicting-disabled');
        } else {
            targetElement.classList.remove('conflicting-disabled');
        }
    }
}

function toggleSelection(clickedElement) {
    if (clickedElement.classList.contains('conflicting-disabled')) {
        return;
    }

    const name = document.getElementById('mainTextBox').value;
    const assigneeSpan = clickedElement.parentElement.querySelector('.assignee');
    const secondaryOptions = clickedElement.parentElement.querySelectorAll('.secondary-option');

    const isCurrentlySelected = clickedElement.classList.contains('selected');

    if (isCurrentlySelected) {
        clickedElement.classList.remove('selected');
        assigneeSpan.textContent = '';
        
        if (secondaryOptions.length > 0) {
            secondaryOptions.forEach(option => {
                option.classList.remove('selected');
                option.classList.add('disabled');
            });
            const appendedTextSpan = clickedElement.parentElement.querySelector('.appended-text');
            if (appendedTextSpan) appendedTextSpan.textContent = '';
        }
        updateMachidaConflict(clickedElement, false);

    } else {
        if (name.trim() === '') {
            alert('マジシャン名を入力してください。');
            return;
        }
        clickedElement.classList.add('selected');
        assigneeSpan.textContent = name;
        
        if (secondaryOptions.length > 0) {
            secondaryOptions.forEach(option => {
                option.classList.remove('disabled');
            });
        }
        updateMachidaConflict(clickedElement, true);
    }
}

function toggleSecondaryOption(clickedElement) {
    if (clickedElement.classList.contains('disabled')) {
        return;
    }
    const appendedTextSpan = clickedElement.parentElement.querySelector('.appended-text');
    const textToAdd = clickedElement.innerText;
    const formattedText = `（${textToAdd}）`;
    
    if (clickedElement.classList.contains('selected')) {
        clickedElement.classList.remove('selected');
        appendedTextSpan.textContent = appendedTextSpan.textContent.replace(formattedText, '').trim();
    } else {
        clickedElement.classList.add('selected');
        appendedTextSpan.textContent = (appendedTextSpan.textContent + ' ' + formattedText).trim();
    }
}

function copyContentToClipboard() {
    let textToCopy = '';
    const shiftBlocks = document.querySelectorAll('#shift-content .shift-block');

    shiftBlocks.forEach(block => {
        const hasSelection = Array.from(block.querySelectorAll('.assignee')).some(span => span.innerText.trim() !== '');

        if (hasSelection) {
            const pElement = block.querySelector('p');
            const pClone = pElement.cloneNode(true);
            pClone.querySelectorAll('.note-red').forEach(el => el.remove());
            let descriptionLines = pClone.innerText.trim().split('\n');
            descriptionLines.pop();
            const processedDescription = descriptionLines.join('\n');
            textToCopy += processedDescription + '\n';

            block.querySelectorAll('.shift-line').forEach(line => {
                const assigneeText = line.querySelector('.assignee').innerText;
                if (assigneeText) {
                    const dateText = line.querySelector('.date-entry').innerText;
                    let appendedText = '';
                    const appendedEl = line.querySelector('.appended-text');
                    if (appendedEl && appendedEl.innerText) {
                        appendedText = ' ' + appendedEl.innerText;
                    }
                    textToCopy += dateText + '｜' + assigneeText + appendedText + '\n';
                }
            });
            textToCopy += '\n'; 
        }
    });

    navigator.clipboard.writeText(textToCopy.trim()).then(() => {
        const notification = document.getElementById('notification');
        notification.classList.add('show');
        setTimeout(() => {
            notification.classList.remove('show');
        }, 3000);
    }).catch(err => {
        console.error('コピーに失敗しました: ', err);
        alert('コピーに失敗しました。');
    });
}
</script>

</body>
</html>
